import{g as h,u as C}from"./updateCartCount-DBnaYKON.js";import{g as A,c as O}from"./getProductFromLS-DcypfGt_.js";import{g as P,p as k}from"./getProductFromJSON-B5AGCLPZ.js";import{s as g}from"./showToast-DYAkwBu6.js";import{o as E}from"./openProductPage-DIZW1DeD.js";const q=[{id:"1",name:"10% OFF",label:"10% off above purchase of $700!",type:"percent",value:10,threshold:700,code:"10_OFF"},{id:"2",name:"20% OFF",label:"20% off above purchase of $1500!",type:"percent",value:20,threshold:1500,code:"20_OFF"},{id:"3",name:"$100 OFF",label:"Flat $100 off above purchase of $500!",type:"dollar",value:100,threshold:500,code:"FLAT100"}],x=()=>{const e=document.getElementById("offers"),t=Number(localStorage.getItem("subtotal"));e.innerHTML="";var r=document.createElement("option");r.value="No Offer",r.innerText="No Offer",e.appendChild(r),q.forEach(a=>{if(t>=Number(a.threshold.toFixed(2))){let o=document.createElement("option");o.value=a.id,o.innerText=a.label,e.appendChild(o)}})},w=()=>{let r=h().reduce((a,o)=>{let l=o.price;return a+l},0);return Number(r.toFixed(2))},D=()=>{var e=Number(localStorage.getItem("subtotal")),t=document.getElementById("checkout");e>0?t.href="checkout.html":t.href="javascript:;"},u=e=>{e=Number(e),document.querySelector(".productDiscount").innerText=`-$${e}`,localStorage.setItem("discount",e)},L=e=>{e=Number(e),document.querySelector(".productShipping").innerText=`$${e}`,localStorage.setItem("shipping",e)},V=e=>{e=Number(e),document.querySelector(".productSubtotal").innerText=`$${e}`,localStorage.setItem("subtotal",e)},J=e=>{e=Number(e),document.querySelector(".productTax").innerText=`$${e}`,localStorage.setItem("tax",e)},y=()=>{let e=Number(localStorage.getItem("tax")),t=Number(localStorage.getItem("shipping")),r=Number(localStorage.getItem("discount")),a=w(),o=Number((a+e+t-r).toFixed(2));J(e),L(t),u(r),V(a),document.querySelector(".productFinalTotal").innerText=`$${o}`,localStorage.setItem("cartTotal",o),D()},S=e=>{e=String(e),document.querySelector("#coupon").value=e,localStorage.setItem("coupon",e)},N=e=>{let t=e.id;t===void 0?document.querySelector("#offers").value="No Offer":document.querySelector("#offers").value=t,localStorage.setItem("selectedOffer",JSON.stringify({id:e.id}))},_=O.maxQuantity,j=(e,t,r,a)=>{const o=document.getElementById(`card-${t}-${r}`),l=o.querySelector(".productQuantity"),b=o.querySelector(".productPrice");let d=h(),n=A(t,r).quantity,i=0,s="";e.target.className==="cartIncrement"&&n<_?n++:e.target.className==="cartDecrement"&&n>1&&n--,i=a*n,i=Number(i.toFixed(2)),d.find(p=>p.id===t&&p.sku===r).price=i,d.find(p=>p.id===t&&p.sku===r).quantity=n,localStorage.setItem("cart",JSON.stringify(d)),l.innerText=n,l.setAttribute("data-quantity",n),b.innerText=`$${i}`;let c=JSON.parse(localStorage.getItem("selectedOffer"))!=null?JSON.parse(localStorage.getItem("selectedOffer")):{};JSON.stringify(c)!="{}"&&(N({}),u(0),S(""),s='Offer auto-removed. <i class="fa-solid fa-check"></i>',g(s)),y(),x()},H=(e,t)=>{const r=P(e);let a=h(),o="",l=a.filter(d=>d.sku!==t);localStorage.setItem("cart",JSON.stringify(l)),C(),document.getElementById(`card-${e}-${t}`).remove();let b=JSON.parse(localStorage.getItem("selectedOffer"));JSON.stringify(b)!="{}"?(N({}),S(""),u(0),o=`Removed ${r.name} removed from cart & auto-removed applied offer. <i class="fa-solid fa-check"></i>`):o=`${r.name} removed from cart. <i class="fa-solid fa-check"></i>`,y(),x(),g(o)},$=e=>{var t=q.find(a=>a.id===e),r=Number(localStorage.getItem("subtotal"));if(t!=null)if(t.type==="percent"){let a=Number((t.value/100*r).toFixed(2));u(a),N(t);let o=t.code;S(o);let l=`Applied coupon ${o}. <i class="fa-solid fa-check"></i>`;g(l)}else{let a=Number(t.value.toFixed(2));u(a),N(t);let o=t.code;S(o);let l=`Applied coupon ${o}. <i class="fa-solid fa-check"></i>`;g(l)}else u(0),N({}),S(""),g('No coupon applied. <i class="fa-solid fa-check"></i>');y()};let T="";const K=e=>{if(e=e.trim(),e!=""){var t=Number(localStorage.getItem("subtotal")),r=q.find(o=>o.code===e);if(r!=null&&t>Number(r.threshold.toFixed(2))){var a=r.id;$(a)}else u(0),$("No Offer"),S(""),y(),T='No such coupon. <i class="fa-solid fa-xmark"></i>',g(T)}},M=document.getElementById("productCartContainer"),R=document.getElementById("productCartTemplate");let U=h();const z=O.tax,G=O.shipping;let B=Number(localStorage.getItem("discount"))!=NaN?Number(localStorage.getItem("discount")):0,F=JSON.parse(localStorage.getItem("selectedOffer"))!=null?JSON.parse(localStorage.getItem("selectedOffer")):{},W=String(localStorage.getItem("coupon")),X=U.filter(e=>k.find(t=>t.id===e.id));const Y=()=>{X.forEach(e=>{k.forEach(t=>{const{id:r,name:a,category:o,brand:l,skus:b,price:d,actualPrice:Q,description:n,image:i}=t,s=e.sku;if(t.id===e.id){const c=document.importNode(R.content,!0);c.querySelector("#cardValue").setAttribute("id",`card-${r}-${s}`),c.querySelector(".productName").innerText=a,c.querySelector(".category").innerText=o,i&&(c.querySelector(".productImage").src=i,c.querySelector(".productImage").alt=`${a}`),c.querySelector(".productSKU").innerText=`${s}`,c.querySelector(".productPrice").innerText=`$${e.price.toFixed(2)}`,c.querySelector(".productQuantity").innerText=`${e.quantity}`,c.querySelector(".productQuantity").setAttribute("data-quantity",e.quantity),c.querySelector(".quantityElement").addEventListener("click",f=>{j(f,r,s,d)}),c.querySelector(".remove-cart-button").addEventListener("click",f=>{H(r,s)}),M.append(c),document.querySelectorAll(".productImage").forEach(f=>{f.addEventListener("click",m=>{var v=m.target.closest(".cards").id.split("-")[1],I=`${m.target.closest(".cards").id.split("-")[2]}-${m.target.closest(".cards").id.split("-")[3]}`;E(v,I)})}),document.querySelectorAll(".productName").forEach(f=>{f.addEventListener("click",m=>{var v=m.target.closest(".cards").id.split("-")[1],I=`${m.target.closest(".cards").id.split("-")[2]}-${m.target.closest(".cards").id.split("-")[3]}`;E(v,I)})})}})})};C();J(z);L(G);u(B);Y();y();x();JSON.stringify(F)!="{}"&&(document.getElementById("offers").value=F.id,document.getElementById("coupon").value=W,u(B));y();document.getElementById("coupon").addEventListener("keypress",e=>{if(e.key==="Enter"){var t=e.target.value;K(t)}});document.getElementById("offers").addEventListener("change",e=>{var t=e.target.value;$(t)});
